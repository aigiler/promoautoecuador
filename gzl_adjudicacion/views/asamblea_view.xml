<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <record id="view_new_asamblea_tree" model= "ir.ui.view">
        <field name="name">view.new.asamblea.tree</field>
        <field name="model">asamblea</field>
        <field name="arch" type="xml">
            <tree string="Asamblea">
                <field name="secuencia" />
                <field name="descripcion" />
                <field name="state" />
                <field name="active"/>
            </tree>
        </field>
    </record>

    <record id="view_new_asamblea_form" model="ir.ui.view">
        <field name="name">view.new.asamblea.form</field>
        <field name="model">asamblea</field>
        <field name="arch" type="xml">
            <form string="Asamblea">
                <header>
                    <button name="cambio_estado_boton_borrador" string="Borrador" type="object" states="borrador" class="oe_highlight"/>
                    <button name="cambio_estado_boton_en_curso" string="En curso" states="en_curso" type="object" class="oe_highlight"/>
                    <button name="cambio_estado_boton_pre_cierre" string="Pre cierre" type="object" states="pre_cierre" class="oe_highlight"/>
                    <button name="cambio_estado_boton_cerrado" string="Cerrado" type="object" states="cerrado" class="oe_highlight"/>

                    <field name="state" widget="statusbar" statusbar_visible="borrador,en_curso,pre_cierre,cerrado"/>
                </header>

                <sheet>
                    <div states="borrador,en_curso,pre_cierre,cerrado">
                        <div class="oe_title">
                            <h1>
                                <field name="secuencia" class="oe_inline" readonly="1"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="tipo_asamblea" attrs="{'readonly': [('state', '=', 'cerrado')]}"/>
                                <field name="descripcion" attrs="{'readonly': [('state', '=', 'cerrado')]}"/>
                                <field name="fecha_inicio" attrs="{'readonly': [('state', '=', 'cerrado')]}"/>
                                <field name="fecha_fin" attrs="{'readonly': [('state', '=', 'cerrado')]}"/>
                                <field name="active" />
                            </group>
                        </group>

                        <group attrs="{'readonly': [('state', '=', 'cerrado')]}">
                            <group string="Integrantes de la Asamblea">
                                <field name="integrantes" nolabel="1" attrs="{'readonly': [('state', '!=', 'borrador')]}">
                                    <tree string="Integrantes" edit="false">
                                        <field name="asamblea_id" invisible="1"/>
                                        <field name="grupo_adjudicado_id"/>
                                    </tree>
                                    <form>
                                        <group>
                                            <field name="integrantes_g" nolabel="1">
                                                <tree string="Integrantes" editable="top">
                                                    <field name="adjudicado_id" />
                                                    <field name="nro_cuota_licitar"/>
                                                    <field name="carta_licitacion" />
                                                </tree>
                                            </field>
                                        </group>
                                    </form>
                                </field>
                            </group>
                            <group string="Junta">
                                <field name="junta" nolabel="1">
                                    <tree string="Junta" editable="top">
                                        <field name="asamblea_id" invisible="1"/>
                                        <field name="empleado_id"/>
                                    </tree>
                                </field>
                            </group>
                        </group>
                    </div>
                </sheet>
            </form >
        </field>
    </record>


    <record id="action_new_asamblea_form" model="ir.actions.act_window">
        <field name="name">Asamblea</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">asamblea</field>
        <field name="view_mode">tree,form</field>
    </record>


    <menuitem id="menu_new_asamblea" action="action_new_asamblea_form" parent="menu_adjudicados" sequence="7" />
</odoo>